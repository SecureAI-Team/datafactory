{
  "name": "AI Data Factory 管理控制台",
  "description": "知识库管理、图谱浏览、推荐配置、摘要查看",
  "version": "1.0.0",
  "screens": [
    {
      "name": "仪表盘",
      "route": "/dashboard",
      "components": [
        {
          "type": "container",
          "props": {
            "direction": "row",
            "gap": "M"
          },
          "children": [
            {
              "type": "statcard",
              "props": {
                "title": "知识单元数",
                "value": "{{stats.ku_count}}",
                "icon": "Book"
              }
            },
            {
              "type": "statcard",
              "props": {
                "title": "图谱节点数",
                "value": "{{stats.graph_nodes}}",
                "icon": "Share"
              }
            },
            {
              "type": "statcard",
              "props": {
                "title": "今日查询",
                "value": "{{stats.queries_today}}",
                "icon": "Search"
              }
            },
            {
              "type": "statcard",
              "props": {
                "title": "用户数",
                "value": "{{stats.user_count}}",
                "icon": "Users"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "知识图谱",
      "route": "/knowledge-graph",
      "components": [
        {
          "type": "form",
          "props": {
            "title": "实体搜索"
          },
          "children": [
            {
              "type": "textfield",
              "props": {
                "label": "搜索关键词",
                "placeholder": "输入产品、参数或场景名称",
                "field": "search_query"
              }
            },
            {
              "type": "button",
              "props": {
                "text": "搜索",
                "onClick": "searchKnowledgeGraph"
              }
            }
          ]
        },
        {
          "type": "datatable",
          "props": {
            "title": "搜索结果",
            "datasource": "kg_search_results",
            "columns": [
              {"name": "name", "label": "实体名称"},
              {"name": "label", "label": "类型"},
              {"name": "properties", "label": "属性"}
            ]
          }
        }
      ]
    },
    {
      "name": "文档上传",
      "route": "/upload",
      "components": [
        {
          "type": "form",
          "props": {
            "title": "上传新文档"
          },
          "children": [
            {
              "type": "fileupload",
              "props": {
                "label": "选择文件",
                "accept": ".pdf,.docx,.txt,.md",
                "field": "document"
              }
            },
            {
              "type": "select",
              "props": {
                "label": "场景分类",
                "options": [
                  {"value": "aoi_inspection", "label": "AOI检测"},
                  {"value": "network_security", "label": "网络安全"},
                  {"value": "cloud_architecture", "label": "云架构"},
                  {"value": "general", "label": "通用"}
                ],
                "field": "scenario_id"
              }
            },
            {
              "type": "select",
              "props": {
                "label": "材料类型",
                "options": [
                  {"value": "product_spec", "label": "产品规格"},
                  {"value": "whitepaper", "label": "白皮书"},
                  {"value": "case_study", "label": "案例研究"},
                  {"value": "faq", "label": "FAQ"},
                  {"value": "general", "label": "通用"}
                ],
                "field": "material_type"
              }
            },
            {
              "type": "button",
              "props": {
                "text": "上传并处理",
                "type": "primary",
                "onClick": "uploadDocument"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "图片分析",
      "route": "/vision",
      "components": [
        {
          "type": "form",
          "props": {
            "title": "图片智能分析"
          },
          "children": [
            {
              "type": "fileupload",
              "props": {
                "label": "上传图片",
                "accept": "image/*",
                "field": "image"
              }
            },
            {
              "type": "textfield",
              "props": {
                "label": "问题（可选）",
                "placeholder": "关于图片想问什么？",
                "field": "question"
              }
            },
            {
              "type": "select",
              "props": {
                "label": "分析类型",
                "options": [
                  {"value": "general_qa", "label": "通用问答"},
                  {"value": "table_extract", "label": "表格提取"},
                  {"value": "chart_analyze", "label": "图表分析"},
                  {"value": "ocr", "label": "文字识别"}
                ],
                "field": "task_type"
              }
            },
            {
              "type": "button",
              "props": {
                "text": "分析图片",
                "type": "primary",
                "onClick": "analyzeImage"
              }
            }
          ]
        },
        {
          "type": "container",
          "props": {
            "title": "分析结果"
          },
          "children": [
            {
              "type": "text",
              "props": {
                "value": "{{vision_result.text_content}}"
              }
            },
            {
              "type": "datatable",
              "props": {
                "title": "提取的表格",
                "datasource": "vision_result.tables",
                "visible": "{{vision_result.tables.length > 0}}"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "推荐管理",
      "route": "/recommendations",
      "components": [
        {
          "type": "container",
          "props": {
            "direction": "column",
            "gap": "L"
          },
          "children": [
            {
              "type": "datatable",
              "props": {
                "title": "热门内容",
                "datasource": "popular_content",
                "columns": [
                  {"name": "ku_id", "label": "KU ID"},
                  {"name": "view_count", "label": "浏览数"},
                  {"name": "click_count", "label": "点击数"},
                  {"name": "score", "label": "热度分"}
                ]
              }
            },
            {
              "type": "form",
              "props": {
                "title": "用户推荐测试"
              },
              "children": [
                {
                  "type": "textfield",
                  "props": {
                    "label": "用户ID",
                    "field": "user_id"
                  }
                },
                {
                  "type": "button",
                  "props": {
                    "text": "获取推荐",
                    "onClick": "getRecommendations"
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "对话摘要",
      "route": "/summaries",
      "components": [
        {
          "type": "form",
          "props": {
            "title": "查看对话摘要"
          },
          "children": [
            {
              "type": "textfield",
              "props": {
                "label": "对话ID",
                "field": "conversation_id"
              }
            },
            {
              "type": "button",
              "props": {
                "text": "查询",
                "onClick": "getSummary"
              }
            }
          ]
        },
        {
          "type": "container",
          "props": {
            "title": "摘要内容"
          },
          "children": [
            {
              "type": "text",
              "props": {
                "value": "{{summary.text}}"
              }
            },
            {
              "type": "list",
              "props": {
                "title": "关键点",
                "datasource": "summary.key_points"
              }
            }
          ]
        }
      ]
    }
  ],
  "datasources": [
    {
      "name": "API",
      "type": "REST",
      "config": {
        "baseUrl": "http://api:8000",
        "defaultHeaders": {
          "Content-Type": "application/json"
        }
      }
    }
  ],
  "automations": [
    {
      "name": "searchKnowledgeGraph",
      "trigger": "button_click",
      "steps": [
        {
          "type": "http_request",
          "config": {
            "method": "GET",
            "url": "/v1/kg/search",
            "params": {
              "q": "{{search_query}}"
            }
          },
          "output": "kg_search_results"
        }
      ]
    },
    {
      "name": "uploadDocument",
      "trigger": "button_click",
      "steps": [
        {
          "type": "http_request",
          "config": {
            "method": "POST",
            "url": "/api/ingest",
            "body": {
              "file": "{{document}}",
              "scenario_id": "{{scenario_id}}",
              "material_type": "{{material_type}}"
            }
          }
        },
        {
          "type": "notification",
          "config": {
            "message": "文档上传成功，正在处理中..."
          }
        }
      ]
    },
    {
      "name": "analyzeImage",
      "trigger": "button_click",
      "steps": [
        {
          "type": "http_request",
          "config": {
            "method": "POST",
            "url": "/v1/vision/analyze",
            "body": {
              "file": "{{image}}",
              "question": "{{question}}",
              "task_type": "{{task_type}}"
            }
          },
          "output": "vision_result"
        }
      ]
    },
    {
      "name": "getRecommendations",
      "trigger": "button_click",
      "steps": [
        {
          "type": "http_request",
          "config": {
            "method": "GET",
            "url": "/v1/recommend",
            "params": {
              "user_id": "{{user_id}}",
              "limit": 10
            }
          },
          "output": "recommendations"
        }
      ]
    },
    {
      "name": "getSummary",
      "trigger": "button_click",
      "steps": [
        {
          "type": "http_request",
          "config": {
            "method": "GET",
            "url": "/v1/summary/{{conversation_id}}"
          },
          "output": "summary"
        }
      ]
    }
  ]
}

